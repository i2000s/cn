<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>Step 7 - Automate the tests</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Xiaodong Qi">
    <!-- Le styles -->
   <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Quattrocento+Sans:bold,bolditalic,italic|Quattrocento+Sans">
   <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Rosario:bold,bolditalic,italic|Rosario">
    <link href="/assets/css/light.css" rel="stylesheet" type="text/css" id="stl" title="light">
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
    <link href="/assets/css/syntax.css" rel="stylesheet" type="text/css" id="stl" title="light">

    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-46730871-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>

  <body> 

  
<!-- Navbar  ================================================== -->
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/README.html">  <img style="float:right;" src="/assets/img/icon-info-circle-inverted.png" alt="info"></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/pubs/index.html">Publications</a></li>

          <li>
          <a href="/noteblog.html">Blog</a></li>

          <!-- <li>
          <a href="/notebooks.html">Notebooks</a></li> -->

          <li>
          <a href="/code.html">Repos</a></li>

          <!-- <li>
          <a href="/teaching.html">Learning</a></li> -->

          <li>
          <a href="/tools.html">Tools</a></li>

          <li>
          <a href="/philosophy.html">Philosophy</a></li>

        </ul>
      </div><!--/.nav-collapse -->
       <form class="navbar-search pull-right" method="get" action="http://google.com/search">
         <input type="hidden" name="q" value="site:">
         <input type="text" class="search-query" name="q">
         <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button>
       </form>
     </div> <!-- /container -->
   </div> <!-- /navbar-inner -->
 </div> <!-- /navbar -->


  <div class="container"> <!-- Twitter bootstrap has all body content in a container -->

    <!-- Custom masthead (big titles) --> 
 
<header class="jumbotron subhead">
    <h1 class="entry-title">Step 7 - Automate the tests</h1>
    <h3></h3>
</header>




      <div class="row">
        <div class="span7 offset1 post">
          <p>Welcome to step 7 in <a href="/2015/05/10/rock_solid_code.html">your training as a scientific Python code ninja</a>: <strong>test automation</strong>.</p>

<p>Tests are extremely useful, as long as you run them.  Unfortunately, a common
pattern in many projects is this:</p>

<ol>
<li>Tests are written and run by the person who wrote them.</li>
<li>Others, and even the test-writer at a future date, forget to run the tests before
committing new code.  Or they decide not to run the tests because they 
forget how, or they don&#39;t want to wait for the tests to finish.</li>
<li>The new code breaks the tests.  By the time somebody notices, it&#39;s too
much trouble to go back and figure out where things went wrong, much
less how to fix them.</li>
</ol>

<p>How do you avoid this?  You make running the tests dead simple and fully
automatic.  This step is about making the tests run with a single command;
step 8 is about having a machine run them whenever you commit code, without
any action on your part.</p>

<p>As a matter of fact, in <a href="/2015/05/15/write_tests.html">Step 5</a> we
set things up so that the tests in one file could by run with a single
command.  But eventually, you will have tests in multiple files.  Besides
doctests, you may write additional tests.  If you need to type 10, or even
3 commands to run them all, there will be a mental barrier and eventually
you&#39;ll get lazy.</p>

<h1>nose</h1>

<p>There are a number of test automation tools for Python, but to keep things
simple I will focus on the one I know best: <a href="https://nose.readthedocs.org/en/latest/">nose</a>.
Nose does one simple thing: it automatically finds all the tests in your
project and runs them.  How does it know where the tests are?  Well, it
can easily recognize doctests, and it will also pick up any function whose
name contains &quot;test&quot; and that is in file whose name contains &quot;test&quot;.</p>

<h1>What to do:</h1>

<p>As usual, this should only take two minutes.</p>

<ol>
<li>In case it isn&#39;t installed already, do <code>pip install nose</code>.</li>
<li>First, go to your project directory and type <code>nosetests --with-doctest</code>.
The nose executable is named &quot;nosetests&quot; and the option <code>--with-doctest</code>
tells it to also run any doctests it finds.  You should get a message
saying that some number of tests were run, with an &quot;OK&quot; at the end.</li>
<li>To see how nosetests becomes really useful, either: (a) add a doctest
in another file; or (b) add a file called <code>tests.py</code> containing at least
one function with &quot;test&quot; in the name.
The test function should check something
and raise an exception if things are wrong.  See <a href="https://github.com/ketch/rock-solid-code-demo/blob/master/tests.py">this example in my 
demo project</a>.</li>
<li>Now type <code>nosetests --with-doctest</code> again.  You should see that your
new tests were also run.  To get more detailed output, try <code>nosetests --with-doctest --vs</code>.</li>
</ol>

<p>That&#39;s it.  Now, if you add more doctests or other tests, you can run them
all just by typing <code>nosetests --with-doctest</code>.  That&#39;s the kind of thing
you might want to add to your README.  Your rule now should be:</p>

<p><strong>Always run the tests before you commit code.</strong></p>

        </div>


        <!-- Custom sidebar -->      
        <div class="span3">
          <div class="sidebar">
            Posted on
<time pubdate datetime="2015-05-29T00:00:00-06:00"
      itemprop="datePublished">29 May 2015</time>.
<br />
          
            <p><a class="btn btn-mini" href='/2015/05/16/track_issues.html'>previous</a>
          
          
            </p>
          


<br />
<p> <a class="btn btn-mini" href="https://github.com/i2000s/i2000s.github.io/commits/master/_posts">history</a></p>
<br />
<br />
<span itemprop="keywords">
            
              <a rel="tag" class="tag" href="/tags.html#python">#python</a>
              , 
            
              <a rel="tag" class="tag" href="/tags.html#testing">#testing</a>
              , 
            
              <a rel="tag" class="tag" href="/tags.html#automation">#automation</a>
              
            
</span>



         </div>
       </div>

      </div>
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>29 May 2015</span> &raquo; <a href="/2015/05/29/automate_tests.html">Step 7 - Automate the tests</a></li>
    
      <li><span>13 Jan 2015</span> &raquo; <a href="/2015/01/13/using_matplotlib_image_comparison.html">Testing whether your code produces the correct plots -- in Python and on Travis</a></li>
    
      <li><span>09 Dec 2014</span> &raquo; <a href="/2014/12/09/teaching_kids_to_program.html">How and why I'm teaching my kids to code</a></li>
    
  </ul>
</div>


      <!-- Disqus Comments -->
      <div class="row">
        <div class="span12">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'qxd'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>

       <footer class="footer">
         <div class="row">
            <div class="span6">

              <a href="mailto:i2000s@hotmail.com" onClick="recordOutboundLink(this, 'Outbound Links', 'email'); return false;"><img src="/assets/img/icon-email.png" alt="email"> </a>
              <a href="https://github.com/i2000s" onClick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><img src="/assets/img/icon-github.png" alt="github"> </a>
              <a href="https://plus.google.com/+XiaodongQi"><img src="/assets/img/icon-gplus.png" alt="G+"></a>
              <a href="http://scholar.google.com/citations?user=6FdqHlIAAAAJ&hl=en"><img src="/assets/img/icon-scholar.png" alt="G+"></a>
              <!-- (<a href="http://figshare.com/authors/Xiaodong_Qi/98644"><img src="/assets/img/icon-figshare.png" alt="Figshare"></a> -->
              <a href="https://twitter.com/i2000s"><img src="/assets/img/icon-twitter.png" alt="Twitter"></a>
              <a href="/atom.xml" onClick="recordOutboundLink(this, 'Outbound Links', 'RSS'); return false;"><img src="/assets/img/icon-rss.png" alt="feed"></a>
              <a href="http://physics.stackexchange.com/users/37682/xiaodong-qi"><img src="/assets/img/icon-stackoverflow.png" alt="Physics Stackexchange"></a>

              <p><a href="/CV-XiaodongQi.pdf">CV of Xiaodong Qi</a></p>
              

            <div class="span4">
              <div class="team-member">
              <img class="img-responsive img-thumbnail img-circle" width="200px" alt="" src="/assets/img/qi2016.jpg" align="middle"></img>

              </div>
                <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">
                  <img alt="Creative Commons License" style="border-width:0" align="right" src="http://i.creativecommons.org/l/by/3.0/88x31.png" /></a>
                  <br /><p>Copyright &copy; 2016 Xiaodong Qi.</p>
                  <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">This site</span> is licensed under the <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.
            </div>
        </div>
      </footer>
    </div><!-- /container -->

        <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js" ></script>
    <script src="http://cdn.jsdelivr.net/jquery.mixitup/latest/jquery.mixitup.min.js"></script>
    <script src="/assets/js/mixitup-mine.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'],['\\(','\\)'] ] } }); </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="/assets/js/bootstrap-collapse.js"></script> <!-- for collapsing navbar-->
    <!-- Unused Twitter Bootstrap Javascript
    <script src="/assets/js/bootstrap-dropdown.js"></script>
    <script src="/assets/js/google-code-prettify/prettify.js"></script>
    <script src="/assets/js/bootstrap-transition.js"></script>
    <script src="/assets/js/bootstrap-alert.js"></script>
    <script src="/assets/js/bootstrap-modal.js"></script>
    <script src="/assets/js/bootstrap-scrollspy.js"></script>
    <script src="/assets/js/bootstrap-tab.js"></script>
    <script src="/assets/js/bootstrap-tooltip.js"></script>
    <script src="/assets/js/bootstrap-popover.js"></script>
    <script src="/assets/js/bootstrap-button.js"></script>
    <script src="/assets/js/bootstrap-carousel.js"></script>
    <script src="/assets/js/bootstrap-typeahead.js"></script>
    <script src="/assets/js/application.js"></script>
    -->

  </body>
</html>

