<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>A curious upwind implicit scheme for advection</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Understanding the CFL condition">
    <meta name="author" content="Xiaodong Qi">
    <!-- Le styles -->
   <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Quattrocento+Sans:bold,bolditalic,italic|Quattrocento+Sans">
   <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Rosario:bold,bolditalic,italic|Rosario">
    <link href="/assets/css/light.css" rel="stylesheet" type="text/css" id="stl" title="light">
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
    <link href="/assets/css/syntax.css" rel="stylesheet" type="text/css" id="stl" title="light">

    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-46730871-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>

  <!-- Go to www.addthis.com/dashboard to customize your tools -->
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-54f225a84524edd3" async="async"></script>

  <body>

  
<!-- Navbar  ================================================== -->
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/README.html">  <img style="float:right;" src="/assets/img/icon-info-circle-inverted.png" alt="info"></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/pubs/index.html">Publications and Actities</a></li>

          <!-- <li>
          <a href="/noteblog.html">Blog</a></li> -->

          <!-- <li>
          <a href="http://i2000s.github.io/notebooks.html">Notebooks</a></li> -->

          <li>
          <a href="/community.html">Community</a></li>

          <!-- <li>
          <a href="http://i2000s.github.io/teaching.html">Learning</a></li> -->

          <!--<li>
          <a href="/tools.html">Tools</a></li>

          <li>
          <a href="/philosophy.html">Philosophy</a></li> -->

        </ul>
      </div><!--/.nav-collapse -->
       <form class="navbar-search pull-right" method="get" action="http://google.com/search">
         <input type="hidden" name="q" value="site:http://i2000s.github.io ">
         <input type="text" class="search-query" name="q">
         <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button>
       </form>
     </div> <!-- /container -->
   </div> <!-- /navbar-inner -->
 </div> <!-- /navbar -->


  <div class="container"> <!-- Twitter bootstrap has all body content in a container -->

    <!-- Custom masthead (big titles) -->

<header class="jumbotron subhead">
    <h1 class="entry-title">A curious upwind implicit scheme for advection</h1>
    <h3>Understanding the CFL condition</h3>
</header>

      <div class="row" margin-left="-50px">
        <div class="span8 post" style="float:left;width:78%;">
          <h2>The CFL condition</h2>

<p>The CFL condition is one of the most basic and intuitive principles
in the numerical solution of hyperbolic PDEs. First formulated by
Courant, Friedrichs and Lewy in their seminal paper (in English for
free here](http://www.stat.uchicago.edu/~lekheng/courses/302/classics/courant-friedrichs-lewy.pdf)), it states that the domain of dependence of a numerical
method for solving a PDE must contain the true domain of dependence.
Otherwise, the numerical method cannot be convergent.</p>

<p>The CFL condition is geometric and easily understood in the context of,
say, a first-order upwind discretization of advection. Usually it says
nothing interesting about implicit schemes, since they include all
points in their domain of dependence. But sometimes understanding the
CFL condition for a particular scheme can be subtle.</p>

<h3>An implicit scheme</h3>

<p>Consider the advection equation</p>

<p>$$u<em>t + a u</em>x = 0.$$</p>

<p>Discretization using a backward difference in space and in time gives
the scheme</p>

<p>$$U^{n+1}<em>j = U^n</em>j - \nu(U^{n+1}<em>j - U^{n+1}</em>{j-1}).$$</p>

<p>Where $\nu = ka/h$ is the CFL number and $k,h$ are the step sizes in
time and space, respectively. This very simple scheme illustrates the
concepts of the CFL condition and stability in a remarkable way.</p>

<p>For simplicity, suppose that the problem is posed on the domain
$0\le x \le 1$, with an appropriate boundary condition. Since this
scheme computes $U^{n+1}<em>j$ in terms of $U^n</em>j$ and $U^{n+1}<em>{j-1}$, it
seems that the numerical domain of dependence for $U^n</em>j$ is
$(x,t)\in (0,x<em>j)\times[0,t</em>n]$. Based on this, we may conclude that the
scheme is not convergent for $\nu&lt;0$. Simple enough.</p>

<p>But what if $\nu=-1$? Then the scheme reads $$U^{n+1}<em>{j-1} = U^n</em>j,$$
which gives <strong>the exact solution</strong>! This is a sort of “anti-unit CFL
condition”.</p>

<p>How can this scheme be convergent (in fact, exact!) for a negative CFL
number when it doesn’t use any values to the right?</p>

<h3>Understanding the CFL condition</h3>

<p>Look at the exact formula above. In this case the scheme is not a method
for computing $U^{n+1}<em>j$ but for computing $U^{n+1}</em>{j-1}$, and it
<em>does</em> use a value from the previous time step that lies to the right.</p>

<p>So we can view the scheme with $\nu=-1$ as a method for computing
$U^{n+1}<em>j$, in which case the CFL condition is satisfied only for
$\nu\ge0$, or we can view the scheme as a method for computing
$U^{n+1}</em>{j-1}$, in which case the CFL condition is satisfied only for
$\nu\le-1$. <strong>Which viewpoint is correct?</strong></p>

<p>To answer that question, remember that the CFL condition is purely
algebraic – that is, it relates to which values are actually used to
compute which other values. To understand this scheme, we need to think
about how we actually solve for $U^{n+1}$ when using it. Notice that the
scheme can be written as $$A U^{n+1} = U^n$$ where the matrix $A$ is
lower-triangular. Hence the system can be solved by substitution. To go
further, we must consider two cases:</p>

<ol>
<li><p>$\nu&gt;0$: in this case, boundary values must be supplied along the
left boundary at $x=0$. Then, starting from the known value at the
boundary, we work to the right by substitution:
$$U^{n+1}<em>j = \frac{U^n</em>j+\nu U^{n+1}<em>{j-1}}{1+\nu}.$$ Hence the
scheme is truly a way of computing $U^{n+1}</em>j$ based on
$U^n<em>j, U^{n+1}</em>{j-1}$ and the resulting CFL condition is $\nu\ge0$.</p></li>
<li><p>$\nu&lt;0$: in this case, boundary values must be supplied along the
right boundary at $x=1$. Then, starting from the known value at the
boundary, we work to the left by substitution:
$$U^{n+1}<em>{j-1} = \frac{(1+\nu)U^{n+1}</em>j - U^n<em>j}{\nu}.$$ Hence the
scheme is truly a way of computing $U^{n+1}</em>{j-1}$ based on
$U^n<em>j, U^{n+1}</em>{j}$ and the resulting CFL condition is $\nu\le-1$.</p></li>
</ol>

<p>This post was originally published on the KAUST Mathwiki <a href="https://mathwiki.kaust.edu.sa/david/A%20curious%20upwind%20implicit%20scheme%20for%20advection">here</a> (login required).</p>

          <!-- Go to www.addthis.com/dashboard to customize your tools -->
          <div class="addthis_sharing_toolbox">ShareIt...</div>
        </div>


        <!-- Custom sidebar -->
        <div class="span2" style="float:right;width:15%;">
          <div class="sidebar">
            Posted on
<time pubdate datetime="2012-10-11T00:00:00+00:00"
      itemprop="datePublished">11 Oct 2012</time>.
<br />
          
            <a class="btn btn-mini" href='/2012/08/28/released.html'>previous</a>
          
          
            <a class="btn btn-mini" href='/2012/10/11/Internal_stability.html'>next</a></p>
          


<span> <a class="btn btn-mini" href="https://github.com/i2000s/i2000s.github.io/commits/master/_posts">commit history</a></span>
<br />
<span itemprop="keywords">
            
              <a rel="tag" class="tag" href="/tags.html#numerical-analysis">#numerical-analysis </a>
              , 
            
              <a rel="tag" class="tag" href="/tags.html#CFL-condition">#CFL-condition </a>
              , 
            
              <a rel="tag" class="tag" href="/tags.html#advection">#advection </a>
              , 
            
              <a rel="tag" class="tag" href="/tags.html#hyperbolic-PDEs">#hyperbolic-PDEs </a>
              
            
</span>

<br />
<div style="font-weight:bold; text-align:center;font-size:1.0em;">
 <i class="icon-chevron-left"></i> <a href="/archives.html">All posts by date,</a>
 <i class="icon-list"></i> <a href="/categories.html">by category,</a>
 <i class="icon-tag"></i> <a href="/tags.html">by tag.</a>
</div>

         </div>
       </div>

      </div>
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>14 Oct 2013</span> &raquo; <a href="/2013/10/14/CFL-disk.html">A Tale of Two Theorems</a></li>
    
      <li><span>11 Oct 2012</span> &raquo; <a href="/2012/10/11/Internal_stability.html">Internal stability of Runge-Kutta methods</a></li>
    
      <li><span>31 May 2011</span> &raquo; <a href="/2011/05/31/positivity-pipe-dream-fulfilled.html">The positivity pipe dream fulfilled?</a></li>
    
  </ul>
</div>


      <!-- Disqus Comments -->
      <div class="row">
        <div class="span12">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'qxd'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>

       <footer class="footer" style="clear:both;">
         <div class="span12">
            <div class="span5" style="float:left;">

              <a href="mailto:i2000s@hotmail.com" onClick="recordOutboundLink(this, 'Outbound Links', 'email'); return false;"><img src="/assets/img/icon-email.png" alt="email"> </a>
              <a href="https://github.com/i2000s" onClick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><img src="/assets/img/icon-github.png" alt="github"> </a>
              <a href="https://plus.google.com/+XiaodongQi"><img src="/assets/img/icon-gplus.png" alt="G+"></a>
              <a href="http://scholar.google.com/citations?user=6FdqHlIAAAAJ&hl=en"><img src="/assets/img/icon-scholar.png" alt="G+"></a>
              <a href="https://twitter.com/i2000s"><img src="/assets/img/icon-twitter.png" alt="Twitter"></a>
              <a href="/atom.xml" onClick="recordOutboundLink(this, 'Outbound Links', 'RSS'); return false;"><img src="/assets/img/icon-rss.png" alt="feed"></a>
              <a href="http://physics.stackexchange.com/users/37682/xiaodong-qi"><img src="/assets/img/icon-stackoverflow.png" alt="Physics Stackexchange"></a>
              <div>
                <br><span> &nbsp; </span> <span><a href="/CV-XiaodongQi.pdf"> CV of Xiaodong Qi</a></span>
                <br><img alt="Creative Commons License" style="border-width:0" align="right" src="https://licensebuttons.net/l/by/3.0/88x31.png" />
                <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">This site</span> is licensed under the
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</a> or specified.
                <br>
              </div>
           </div>

           <div class="span4" style="float:right;">
              <div class="span4 team-member" marge-top="-20px">
              <img class="img-responsive img-thumbnail img-circle" width="200px" alt="" src="/assets/img/qi2016.jpg" align="middle"></img>
           </div>

      </div>
      <div class="span12" align="center" clear="both">
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
              <span align="center" margin-top="-10px">Copyright &copy; 2016 Xiaodong Qi. </span></a>
            <br>
      </div>

    </footer>
   </div><!-- /container -->

        <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js" ></script>
    <script src="//cdn.jsdelivr.net/jquery.mixitup/latest/jquery.mixitup.min.js"></script>
    <script src="/assets/js/mixitup-mine.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'],['\\(','\\)'] ] } }); </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="/assets/js/bootstrap-collapse.js"></script> <!-- for collapsing navbar-->
    <!-- Unused Twitter Bootstrap Javascript
    <script src="http://i2000s.github.io/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://i2000s.github.io/assets/js/google-code-prettify/prettify.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-transition.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-alert.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-modal.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-tab.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-tooltip.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-popover.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-button.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-carousel.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-typeahead.js"></script>
    <script src="http://i2000s.github.io/assets/js/application.js"></script>
    -->

  </body>
</html>

