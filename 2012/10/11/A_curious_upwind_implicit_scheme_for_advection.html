<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>A curious upwind implicit scheme for advection</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv = "X-UA-Compatible" content = "IE = edge">
      <!--[if lt IE 9]>
      <script src = "https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src = "https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
      <![endif]-->
    <meta name="subtitle" content="Understanding the CFL condition">
    <meta name="author" content="Xiaodong Qi | 戚晓东">
    
    <!-- HTML5 metadata -->

  <meta name="keywords" content="Xiaodong Qi, 戚晓东, numerical-analysis, CFL-condition, advection, hyperbolic-PDEs" />
  



  <meta name="description" content="Understanding the CFL condition" />
  


<meta http-equiv="Content-Language" content="en, zh-Hans, cmn">
<!-- RDFa Metadata (in DublinCore) -->
<meta property="dc:title" content="A curious upwind implicit scheme for advection" />
<meta property="dc:creator" content="Xiaodong Qi" />
<meta property="dc:date" content="2012-10-11 00:00:00 +0000" />
<meta property="dc:format" content="text/html" />
<meta property="dc:language" content="en" />
<meta property="dc:identifier" content="/2012/10/11/A_curious_upwind_implicit_scheme_for_advection.html" />
<meta property="dc:rights" content="CC-BY" />
<meta property="dc:source" content="The NoteBlog of Xiaodong Qi" />
<meta property="dc:subject" content="Physics" /> 
<meta property="dc:type" content="website" /> 
<meta name="dc.language" content="en, zh-Hans, cmn">
<!-- RDFa Metadata (in OpenGraph) -->
<meta property="og:title" content="A curious upwind implicit scheme for advection" />
<meta property="og:author" content="http://i2000s.github.io/index.html" />  <!-- Should be Liquid? URI? -->
<meta property="http://ogp.me/ns/profile#first_name" content="Xiaodong"/>
<meta property="http://ogp.me/ns/profile#last_name" content="Qi"/>
<meta property="http://ogp.me/ns/article#published_time" content="2012-10-11 00:00:00 +0000" />
<meta property="og:site_name" content="The NoteBlog of Xiaodong Qi" /> <!-- Same as dc:source? -->
<meta property="og:url" content="http://i2000s.github.io/2012/10/11/A_curious_upwind_implicit_scheme_for_advection.html" />
<meta property="og:type" content="website" /> 
<!-- Google Scholar Metadata -->
<meta name="citation_author" content="Xiaodong Qi"/>
<meta name="citation_date" content="2012-10-11 00:00:00 +0000"/>
<meta name="citation_title" content="A curious upwind implicit scheme for advection"/>
<meta name="citation_journal_title" content="The NoteBlog of Xiaodong Qi"/>
<!--NOTE: see also the COinS Metadata in span element in coins.html and footer. -->
<!-- Twitter card summary -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@i2000s" />
<meta name="twitter:title" content="A curious upwind implicit scheme for advection" />
<meta name="twitter:description" content="Understanding the CFL condition" />
<meta name="twitter:image" content="http://i2000s.github.io/assets/img/qi2016.jpg" />
<!-- Baidu website verification code -->
<meta name="baidu-site-verification" content="cAv3dLIDps" />

    <!-- Le styles -->
   <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Quattrocento+Sans:bold,bolditalic,italic|Quattrocento+Sans">
   <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Rosario:bold,bolditalic,italic|Rosario">
    <link href="/assets/css/light.css" rel="stylesheet" type="text/css" id="stl" title="light">
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
    <link href="/assets/css/syntax.css" rel="stylesheet" type="text/css" id="stl" title="light">
    <!-- bootstrap style -->
    <!-- <link href="/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css"/> -->
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
    <link href = "/assets/css/bootstrap.min.css" rel = "stylesheet">

    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-74657818-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

      
    <!-- Help the browser identify the RSS feed automatically -->
    <link rel="alternate" type="application/rss+xml" title="Xiaodong Qi's Website" href="/atom.xml" />
  </head>

  <!-- Go to www.addthis.com/dashboard to customize your tools -->
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-54f225a84524edd3" async="async"></script>

  <body>

  
<!-- Navbar  ================================================== -->
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/README.html"><i class="glyphicon glyphicon-info-sign"></i></a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/pubs/index.html">Publications and Activities</a></li>

          <!-- <li>
          <a href="/noteblog.html">Blog</a></li> -->

          <!-- <li>
          <a href="http://i2000s.github.io/notebooks.html">Notebooks</a></li> -->

          <li>
          <a href="/community.html">Community</a></li>

          <!-- <li>
          <a href="http://i2000s.github.io/teaching.html">Learning</a></li> -->

          <!--<li>
          <a href="/tools.html">Tools</a></li>

          <li>
          <a href="/philosophy.html">Philosophy</a></li> -->

        </ul>
      <!-- Search site using Google's index -->
        <form class="navbar-form navbar-right" role="search" method="get" action="http://google.com/search">
          <div class="form-group">
            <input type="hidden" name="q" value="site:i2000s.github.io" />
            <input type="text" class="form-control search-query" name="q" placeholder="Search this site"/>
          </div>
          <button class="btn btn-default" type="submit"><i class="glyphicon glyphicon-search"></i></button> 
       </form>

    </div><!--/.nav-collapse -->
  </div> <!-- /container -->
</nav>

  <div class="container"> <!-- Twitter bootstrap has all body content in a container -->

    <!-- Custom masthead (big titles) -->

<header class="jumbotron subhead">
    <h1 class="entry-title">A curious upwind implicit scheme for advection</h1>
    <h3>Understanding the CFL condition</h3>
</header>

<!-- <style>
div #sticker {
  width:auto;
  padding:10px;
  margin-right:20px;
  float:right;
}
.stick {
    position:fixed;
    top:30px;}
</style>
<script type="text/javascript">
$(document).ready(function() {
    var s = $("#sticker");
    var pos = s.position();
    $(window).scroll(function() {
        var windowpos = $(window).scrollTop();
        if (windowpos >= pos.top) {
            s.addClass("stick");
        } else {
            s.removeClass("stick");
        }
    });
});
</script> -->

      <div class="row" margin-left="-50px">
        <div class="col-md-7 col-md-offset-1"> 
          <article>
          <h2 id="the-cfl-condition">The CFL condition</h2>
<p>The CFL condition is one of the most basic and intuitive principles in the numerical solution of hyperbolic PDEs. First formulated by Courant, Friedrichs and Lewy in their seminal paper (in English for free here](http://www.stat.uchicago.edu/~lekheng/courses/302/classics/courant-friedrichs-lewy.pdf)), it states that the domain of dependence of a numerical method for solving a PDE must contain the true domain of dependence. Otherwise, the numerical method cannot be convergent.</p>
<p>The CFL condition is geometric and easily understood in the context of, say, a first-order upwind discretization of advection. Usually it says nothing interesting about implicit schemes, since they include all points in their domain of dependence. But sometimes understanding the CFL condition for a particular scheme can be subtle.</p>
<h3 id="an-implicit-scheme">An implicit scheme</h3>
<p>Consider the advection equation</p>
<p><span class="math">\[u_t + a u_x = 0.\]</span></p>
<p>Discretization using a backward difference in space and in time gives the scheme</p>
<p><span class="math">\[U^{n+1}_j = U^n_j - \nu(U^{n+1}_j - U^{n+1}_{j-1}).\]</span></p>
<p>Where <span class="math">\(\nu = ka/h\)</span> is the CFL number and <span class="math">\(k,h\)</span> are the step sizes in time and space, respectively. This very simple scheme illustrates the concepts of the CFL condition and stability in a remarkable way.</p>
<p>For simplicity, suppose that the problem is posed on the domain <span class="math">\(0\le x \le 1\)</span>, with an appropriate boundary condition. Since this scheme computes <span class="math">\(U^{n+1}_j\)</span> in terms of <span class="math">\(U^n_j\)</span> and <span class="math">\(U^{n+1}_{j-1}\)</span>, it seems that the numerical domain of dependence for <span class="math">\(U^n_j\)</span> is <span class="math">\((x,t)\in (0,x_j)\times[0,t_n]\)</span>. Based on this, we may conclude that the scheme is not convergent for <span class="math">\(\nu&lt;0\)</span>. Simple enough.</p>
<p>But what if <span class="math">\(\nu=-1\)</span>? Then the scheme reads <span class="math">\[U^{n+1}_{j-1} = U^n_j,\]</span> which gives <strong>the exact solution</strong>! This is a sort of “anti-unit CFL condition”.</p>
<p>How can this scheme be convergent (in fact, exact!) for a negative CFL number when it doesn’t use any values to the right?</p>
<h3 id="understanding-the-cfl-condition">Understanding the CFL condition</h3>
<p>Look at the exact formula above. In this case the scheme is not a method for computing <span class="math">\(U^{n+1}_j\)</span> but for computing <span class="math">\(U^{n+1}_{j-1}\)</span>, and it <em>does</em> use a value from the previous time step that lies to the right.</p>
<p>So we can view the scheme with <span class="math">\(\nu=-1\)</span> as a method for computing <span class="math">\(U^{n+1}_j\)</span>, in which case the CFL condition is satisfied only for <span class="math">\(\nu\ge0\)</span>, or we can view the scheme as a method for computing <span class="math">\(U^{n+1}_{j-1}\)</span>, in which case the CFL condition is satisfied only for <span class="math">\(\nu\le-1\)</span>. <strong>Which viewpoint is correct?</strong></p>
<p>To answer that question, remember that the CFL condition is purely algebraic – that is, it relates to which values are actually used to compute which other values. To understand this scheme, we need to think about how we actually solve for <span class="math">\(U^{n+1}\)</span> when using it. Notice that the scheme can be written as <span class="math">\[A U^{n+1} = U^n\]</span> where the matrix <span class="math">\(A\)</span> is lower-triangular. Hence the system can be solved by substitution. To go further, we must consider two cases:</p>
<ol type="1">
<li><p><span class="math">\(\nu&gt;0\)</span>: in this case, boundary values must be supplied along the left boundary at <span class="math">\(x=0\)</span>. Then, starting from the known value at the boundary, we work to the right by substitution: <span class="math">\[U^{n+1}_j = \frac{U^n_j+\nu U^{n+1}_{j-1}}{1+\nu}.\]</span> Hence the scheme is truly a way of computing <span class="math">\(U^{n+1}_j\)</span> based on <span class="math">\(U^n_j, U^{n+1}_{j-1}\)</span> and the resulting CFL condition is <span class="math">\(\nu\ge0\)</span>.</p></li>
<li><p><span class="math">\(\nu&lt;0\)</span>: in this case, boundary values must be supplied along the right boundary at <span class="math">\(x=1\)</span>. Then, starting from the known value at the boundary, we work to the left by substitution: <span class="math">\[U^{n+1}_{j-1} = \frac{(1+\nu)U^{n+1}_j - U^n_j}{\nu}.\]</span> Hence the scheme is truly a way of computing <span class="math">\(U^{n+1}_{j-1}\)</span> based on <span class="math">\(U^n_j, U^{n+1}_{j}\)</span> and the resulting CFL condition is <span class="math">\(\nu\le-1\)</span>.</p></li>
</ol>
<p>This post was originally published on the KAUST Mathwiki <a href="https://mathwiki.kaust.edu.sa/david/A%20curious%20upwind%20implicit%20scheme%20for%20advection">here</a> (login required).</p>

          </article>
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
          <div class="addthis_sharing_toolbox">Share on</div>
        </div>


        <!-- Custom sidebar -->
        <div class="col-md-4">
          <!-- <div id="sticker" style="width:250px"> --> <!--class="sidebar">-->
            <aside prefix="og:http://ogp.me/ns/article#">
  <p> <i class="glyphicon glyphicon-calendar"></i>
    <time datetime="2012-10-11 00:00:00 +0000" 
    property="dc:created">11 Oct 2012</time></p>
   

 <br />
          
            <p><a class="btn btn-default" href='/2012/08/28/released.html'><i class="glyphicon glyphicon-chevron-left"></i> prev</a>
          
          
            <a class="btn btn-default" href='/2012/10/11/Internal_stability.html'>next <i class="glyphicon glyphicon-chevron-right"></i></a></p>
          


 <p> <a  onclick="recordOutboundLink(this, 'Outbound Links', 'history'); 
            return false;" 
          class="btn btn-default" 
          href="https://github.com/i2000s/i2000s.github.io/commits/dev/_posts/2012-10-11-A_curious_upwind_implicit_scheme_for_advection.md"><i class="glyphicon glyphicon-time"></i> history</a></p>

  <br />

  <p><i class="glyphicon glyphicon-list"></i> Posted in 
     
      <a rel="dc:subject" class="category" 
         href="/categories.html#notebook">notebook</a>
    
    </p>

  <p> <i class="glyphicon glyphicon-tag"></i> tags: 
    
    <!-- http://schema.org/BlogPosting/keywords -->
    <a rel="og:tag" class="tag" 
       href="/tags.html#numerical-analysis">#numerical-analysis</a>, 
    
    <!-- http://schema.org/BlogPosting/keywords -->
    <a rel="og:tag" class="tag" 
       href="/tags.html#CFL-condition">#CFL-condition</a>, 
    
    <!-- http://schema.org/BlogPosting/keywords -->
    <a rel="og:tag" class="tag" 
       href="/tags.html#advection">#advection</a>, 
    
    <!-- http://schema.org/BlogPosting/keywords -->
    <a rel="og:tag" class="tag" 
       href="/tags.html#hyperbolic-PDEs">#hyperbolic-PDEs</a>
    </p>

  <!-- <br/>

  

  <br/> -->
  <!-- <p><tiny> <i class="glyphicon glyphicon-barcode"></i> SHA Hash: <a href="https://github.com/i2000s/i2000s.github.io/commit/fc77cab254f7752a2600797b42ac6d987540a5bf/_posts/2012-10-11-A_curious_upwind_implicit_scheme_for_advection.md"> fc77cab254f7752a2600797b42ac6d987540a5bf</a></tiny></p> -->
</aside>

<br /><br />
<div style="font-weight:bold; text-align:center;font-size:1.0em;">
 <i class="glyphicon glyphicon-chevron-left"></i> <a href="/archives.html">Archieves by date,</a>
 <i class="glyphicon glyphicon-list"></i> <a href="/categories.html">by category,</a>
 <i class="glyphicon glyphicon-tag"></i> <a href="/tags.html">by tag.</a>
</div>

         <!-- </div> -->
       </div>

      </div>
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>14 Oct 2013</span> &raquo; <a href="/2013/10/14/CFL-disk.html">A Tale of Two Theorems</a></li>
    
      <li><span>11 Oct 2012</span> &raquo; <a href="/2012/10/11/Internal_stability.html">Internal stability of Runge-Kutta methods</a></li>
    
      <li><span>31 May 2011</span> &raquo; <a href="/2011/05/31/positivity-pipe-dream-fulfilled.html">The positivity pipe dream fulfilled?</a></li>
    
  </ul>
</div>


      <!-- Disqus Comments -->
      <div class="row">
        <div class="span12">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'qxd'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>

       <footer class="footer" style="clear:both;">
         <div class="span12">
            <div class="span5" style="float:left;">

              <a href="mailto:i2000s@hotmail.com" onClick="recordOutboundLink(this, 'Outbound Links', 'email'); return false;"><img src="/assets/img/icon-email.png" alt="email"> </a>
              <a href="https://github.com/i2000s" onClick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><img src="/assets/img/icon-github.png" alt="github"> </a>
              <a href="https://plus.google.com/+XiaodongQi"><img src="/assets/img/icon-gplus.png" alt="G+"></a>
              <a href="http://scholar.google.com/citations?user=6FdqHlIAAAAJ&hl=en"><img src="/assets/img/icon-scholar.png" alt="GoogleScholar"></a>
              <a href="https://twitter.com/i2000s"><img src="/assets/img/icon-twitter.png" alt="Twitter"></a>
              <a href="/atom.xml" onClick="recordOutboundLink(this, 'Outbound Links', 'RSS'); return false;"><img src="/assets/img/icon-rss.png" alt="feed"></a>
              <a href="http://physics.stackexchange.com/users/37682/xiaodong-qi"><img src="/assets/img/icon-stackoverflow.png" alt="Physics Stackexchange"></a>
              <div>
                <br><span> &nbsp; </span> <span><a href="/CV-XiaodongQi.pdf"> CV of Xiaodong Qi</a></span>
                <br><img alt="Creative Commons License" style="border-width:0" align="right" src="https://licensebuttons.net/l/by/3.0/88x31.png" />
                <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">This site</span> is licensed under the
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</a> or specified.
                <br>
              </div>
           </div>
             
           <div class="span4" style="float:right;">
              <div class="span4 team-member" marge-top="-20px">
              <img class="img-responsive img-thumbnail img-circle" width="200px" alt="" src="/assets/img/qi2016.jpg" align="middle">
              </div>
           </div>
         </div>
      <div class="span12" align="center" clear="both">
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
              <span align="center" margin-top="-10px">Copyright &copy; 2016 Xiaodong Qi. </span></a>
            <br>
      </div>
      
<!-- COinS metadata (for citation managers like Zotero etc), goes in body text -->
  <span
      class="Z3988" 
      title="ctx_ver=Z39.88-2004
      &amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Adc
      &amp;rfr_id=info%3Asid%2Focoins.info%3Agenerator
      &amp;rft.title=A curious upwind implicit scheme for advection
      &amp;rft.creator=Xiaodong Qi
      &amp;rft.date=2012-10-11
      &amp;rft.language='en-US, zh-Hans'
      &amp;rft.rights='CC-BY'
      &amp;rft_id=http://i2000s.github.io/2012/10/11/A_curious_upwind_implicit_scheme_for_advection.html">
  </span>

    </footer>
   </div><!-- /container -->

        <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js" ></script>
    <script src="//cdn.jsdelivr.net/jquery.mixitup/latest/jquery.mixitup.min.js"></script>
    <script src="/assets/js/mixitup-mine.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'],['\\(','\\)'] ] } }); </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="/assets/js/bootstrap-collapse.js"></script> <!-- for collapsing navbar-->
    <!-- Unused Twitter Bootstrap Javascript
    <script src="http://i2000s.github.io/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://i2000s.github.io/assets/js/google-code-prettify/prettify.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-transition.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-alert.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-modal.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-tab.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-tooltip.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-popover.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-button.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-carousel.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-typeahead.js"></script>
    <script src="http://i2000s.github.io/assets/js/application.js"></script>
    -->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src = "https://code.jquery.com/jquery.js"></script>
      
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src = "/assets/js/bootstrap.min.js"></script>
  </body>
</html>

