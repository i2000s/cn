<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>Dispersion relations for linear systems of PDEs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Xiaodong Qi">
    <!-- Le styles -->
   <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Quattrocento+Sans:bold,bolditalic,italic|Quattrocento+Sans">
   <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Rosario:bold,bolditalic,italic|Rosario">
    <link href="/assets/css/light.css" rel="stylesheet" type="text/css" id="stl" title="light">
    <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
    <link href="/assets/css/syntax.css" rel="stylesheet" type="text/css" id="stl" title="light">

    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-46730871-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>

  <!-- Go to www.addthis.com/dashboard to customize your tools -->
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-54f225a84524edd3" async="async"></script>

  <body>

  
<!-- Navbar  ================================================== -->
<div class="navbar navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/README.html">  <img style="float:right;" src="/assets/img/icon-info-circle-inverted.png" alt="info"></a>
      <div class="nav-collapse">
        <ul class="nav">
          <li>
          <a href="/index.html">Home</a></li>

          <li>
          <a href="/research.html">Research</a></li>

          <li>
          <a href="/pubs/index.html">Publications and Actities</a></li>

          <!-- <li>
          <a href="/noteblog.html">Blog</a></li> -->

          <!-- <li>
          <a href="http://i2000s.github.io/notebooks.html">Notebooks</a></li> -->

          <li>
          <a href="/community.html">Community</a></li>

          <!-- <li>
          <a href="http://i2000s.github.io/teaching.html">Learning</a></li> -->

          <!--<li>
          <a href="/tools.html">Tools</a></li>

          <li>
          <a href="/philosophy.html">Philosophy</a></li> -->

        </ul>
      </div><!--/.nav-collapse -->
       <form class="navbar-search pull-right" method="get" action="http://google.com/search">
         <input type="hidden" name="q" value="site:http://i2000s.github.io ">
         <input type="text" class="search-query" name="q">
         <button class="btn btn-mini" type="submit"><i class="icon-search"></i></button>
       </form>
     </div> <!-- /container -->
   </div> <!-- /navbar-inner -->
 </div> <!-- /navbar -->


  <div class="container"> <!-- Twitter bootstrap has all body content in a container -->

    <!-- Custom masthead (big titles) -->

<header class="jumbotron subhead">
    <h1 class="entry-title">Dispersion relations for linear systems of PDEs</h1>
    <h3></h3>
</header>

<style>
div #sticker {
  width:150px;
  padding:20px;
  margin-right:30px;
  float:right;
}
.stick {
    position:fixed;
    top:40px;}
</style>
<script type="text/javascript">
$(document).ready(function() {
    var s = $("#sticker");
    var pos = s.position();
    $(window).scroll(function() {
        var windowpos = $(window).scrollTop();
        s.html("Distance from top:" + pos.top + "<br />Scroll position: " + windowpos);
        if (windowpos >= pos.top) {
            s.addClass("stick");
        } else {
            s.removeClass("stick");
        }
    });
});
</script>

      <div class="row" margin-left="-50px">
        <div class="span8 post" style="float:left;width:74%;">
          <p>Fourier analysis is an essential tool for understanding the behavior of
solutions to linear equations.  Often, this analysis is introduced to students in the
context of scalar equations with real coefficients.  If nothing more is said,
students may mistakenly apply assumptions based on the scalar case to systems,
leading to erroneous conclusions.  I&#39;m surprised at how often I&#39;ve seen
this, and I&#39;ve even made the mistake myself.</p>

<h2>Scalar equations</h2>

<p>Students in any undergraduate PDE course learn that solutions of the heat equation</p>

<p>$$
\label{heat}
u<em>t(x,t) = u</em>{xx}(x,t)
$$</p>

<p>diffuse in time whereas solutions of the wave equation</p>

<p>$$
\label{wave}
u<em>{tt} = u</em>{xx}
$$</p>

<p>oscillate in time without growing or decaying.  They may even be introduced to
a general approach for the Cauchy problem: given an evolution equation</p>

<p>$$ \label{evol}
u<em>t = \sum</em>{j=0}^n a_j \frac{\partial^j u}{\partial x^j},
$$</p>

<p>one inserts the Fourier mode solution</p>

<p>$$ \label{fourier}
u(x,t) = e^{i(kx - \omega(k) t)}
$$</p>

<p>to obtain</p>

<p>$$-i\omega(k) = \sum<em>{j=0}^n a</em>j (ik)^j$$</p>

<p>or simply</p>

<p>$$\omega(k) = \sum<em>{j=0}^n a</em>j i^{j+1} k^j.$$</p>

<p>The function $\omega(k)$ is often referred to as the <em>dispersion relation</em> for the PDE.  Any solution can be expressed as a sum of Fourier modes, and each mode propagates in a manner dictated by the dispersion relation.  It&#39;s easy to see that</p>

<ul>
<li>If $\omega(k)$ is <strong>real</strong>, then energy is conserved and each mode simply translates.  This occurs if only odd-numbered spatial derivatives appear in the evolution equation  \eqref{evol}.</li>
<li>If $\omega(k)$ has <strong>negative imaginary part</strong>, energy decays in time.  The heat equation \eqref{heat} behaves this way.</li>
<li>If $\omega(k)$ has <strong>positive imaginary part</strong>, then the energy will grow exponentially in time.  This doesn&#39;t usually occur in physical systems.  An example of this behavior is obtained by changing the sign of the right side in the heat equation to get $u<em>t = - u</em>{xx}$.</li>
</ul>

<p>What about the wave equation, which has two time derivatives?  Using the same Fourier mode ansatz
\eqref{fourier}, one obtains
$$
\begin{align}
\omega^2 &amp; = k^2
\end{align}
$$
or $\omega = \pm k$.  Since $\omega$ is real, energy is conserved.</p>

<p>In the discussion above, we have assumed that $u$ is a scalar and that the coefficients $a_j$ are real.  Many undergraduate courses stop at this point, and students are left with the intuition that <strong>even-numbered derivative terms are diffusive</strong> while <strong>odd-numbered derivative terms are dispersive</strong>.</p>

<p>In practice, we often deal with systems of PDEs or PDEs with complex coefficients, and this intuition is then no longer correct.  There is nothing deep or mysterious about this topic, but it&#39;s easy to jump to incorrect conclusions if one is not careful.  To take a common example, consider the time-dependent Schroedinger equation:
$$i \psi<em>t = \psi</em>{xx} + V\psi.$$
At first glance, we have on the right side a diffusion term ($\psi_{xx}$) and a reaction term ($V\psi$).  But what about that pesky factor of $i$ (the imaginary unit) on the left hand side?  It&#39;s easy to find the answer using the usual ansatz, but let&#39;s take a little detour first.</p>

<h2>Systems of equations</h2>

<p>Consider the linear system
$$
\begin{align<em>}
u_t = A  \frac{\partial^j u}{\partial x^j},
\end{align</em>}
$$
where $u\in \mathbb{R}^m$ and $A$ is a square real matrix.
Let $\lambda<em>m$ and $s</em>m$ denote the eigenvalues and eigenvectors (respectively) of $A$.
Inserting the Fourier mode solution
$$u(x,t) = s<em>m e^{i(kx - \omega(k) t)},$$
we obtain
$$\omega(k) = i^{j+1} k^j \lambda</em>m s<em>m,$$
and any solution can be written as a superposition of these.  We see now that the behavior of the energy with respect to time depends on both the number $j$ of spatial derivatives and the nature of the eigenvalues of $A$.  For instance, if $j=1$ and $A$ has imaginary eigenvalues, energy is conserved.  We can obtain just such an example by rewriting the wave equation \eqref{wave} as a first-order system:
$$
\begin{align}
u</em>t &amp; = v<em>x \label{w1} \
v</em>t &amp; = u_x. \label{w2}
\end{align}
$$
(If you&#39;re not familiar with this, just differentiate \eqref{w1} w.r.t. $t$ and \eqref{w2} w.r.t. $x$, then equate partial derivatives to get back the second-order wave equation \eqref{wave}).  We have a linear system with $j=1$ and 
$$ A = \begin{pmatrix}
0 &amp; 1 \ 1 &amp; 0
\end{pmatrix}.$$
This matrix has eigenvalues $\lambda=\pm 1$, so $\omega(k)$ has zero imaginary part.</p>

<p>In this example, our intuition from the scalar case works: our first-order system, with only odd-numbered derivatives, leads to wave-like behavior.  But notice that if $A$ had imaginary eigenvalues, our intuition would be wrong; for instance, the system
$$
\begin{align<em>}
u<em>t &amp; = -v</em>x \
v<em>t &amp; = u</em>x,
\end{align</em>}
$$
corresponding to the second-order equation $u<em>{tt} = - u</em>{xx},$ admits exponentially growing solutions.</p>

<h2>Scalar problems with complex coefficients</h2>

<p>Now that we understand the dispersion relation for systems, it&#39;s easy to understand the dispersion relation for the Schrodinger equation.  Multiply by $-i$ to get
$$\psi<em>t = -i\psi</em>{xx} + -iV\psi.$$
Now we can think of this in the same way as a system, where the coefficient matrices have purely imaginary eigenvalues.  Then it&#39;s clear that the (even-derivative) terms on the right hand side are both related to wave behavior (i.e., energy is conserved).</p>

<h2>Systems with derivatives of different orders</h2>

<p>In the most general case, we have systems of linear PDEs with multiple spatial derivatives
of different order:
$$ \label{gensys}
u<em>t = \sum</em>{j=0}^n A_j  \frac{\partial^j u}{\partial x^j}.
$$</p>

<p>Here&#39;s a real example from my research.  It comes from homogenization of
the wave equation in a spatially varying medium 
(see Equation (5.17) of <a href="http://faculty.washington.edu/rjl/pubs/solitary/40815.pdf">this paper</a> for 
more details).  It&#39;s the wave equation plus some second-derivative terms:
$$
u<em>t = v</em>x + v<em>{xx} \
v</em>t = u<em>x - u</em>{xx}.
$$
You might (if you hadn&#39;t read the example above) assume that this system
is dissipative due to the second derivatives.
This system is of the form \eqref{gensys} with
$$
\begin{align}
A<em>1 &amp; = \begin{pmatrix}
0 &amp; 1 \ 1 &amp; 0
\end{pmatrix}
&amp;
A</em>2 &amp; = \begin{pmatrix}
0 &amp; 1 \ -1 &amp; 0
\end{pmatrix}.
\end{align}
$$
Of course, $A<em>1$ has real eigenvalues and leads to wave-like behavior.
But $A</em>2$ has pure imaginary eigenvalues, so it also leads to wave-like
behavior! The second derivative terms are <em>dispersive</em>.  In fact, it&#39;s
easy to show that the energy $E=u^2+v^2$ is a conserved quantity for this
system (try it!).</p>

<p>Strictly speaking, Fourier analysis like what we&#39;ve described can&#39;t usually be
applied to \eqref{gensys} because the matrices $A_j$ will not generally be simultaneously
diagonalizable (though this analysis can still give us intuition for what
each set of terms may do).  Worse yet, the individual matrices may not
be diagonalizable.  Let&#39;s illustrate with a simple case.</p>

<p>Returning to the wave equation, let&#39;s consider a different way of writing it as a system:
$$
\begin{align<em>}
u<em>t &amp; = v \ 
v</em>t &amp; = u_{xx}.
\end{align</em>}
$$
It&#39;s easy to check that this system is equivalent to the wave equation -- but notice that it&#39;s composed of parts with only even derivatives! (<em>reaction</em> and <em>diffusion</em> equations in the terminology of scalar PDEs).  This system is of the form \eqref{gensys} with
$$
\begin{align}
A<em>0 &amp; = \begin{pmatrix}
0 &amp; 1 \ 0 &amp; 0
\end{pmatrix}
&amp;
A</em>2 &amp; = \begin{pmatrix}
0 &amp; 0 \ 1 &amp; 0
\end{pmatrix}.
\end{align}
$$
Notice that both eigenvalues of both matrices are equal to zero.</p>

          <!-- Go to www.addthis.com/dashboard to customize your tools -->
          <div class="addthis_sharing_toolbox">ShareIt...</div>
        </div>


        <!-- Custom sidebar -->
        <div class="span2" style="float:right;width:22%;">
          <div id="sticker"> <!--class="sidebar">-->
            Posted on
<time pubdate datetime="2014-05-28T00:00:00+00:00"
      itemprop="datePublished">28 May 2014</time>.
<br /><br />
          
            <a class="btn btn-mini" href='/2014/03/11/DMDA_memory.html'>previous</a>
          
          
            <a class="btn btn-mini" href='/2014/05/28/hyperpython.html'>next</a></p>
          


<span> <a class="btn btn-mini" href="https://github.com/i2000s/i2000s.github.io/commits/master/_posts">commit history</a></span>
<br /><br />
<span itemprop="keywords">
            
              <a rel="tag" class="tag" href="/tags.html#wave-equation">#wave-equation </a>
              , 
            
              <a rel="tag" class="tag" href="/tags.html#PDE">#PDE </a>
              , 
            
              <a rel="tag" class="tag" href="/tags.html#mathematical-exposition">#mathematical-exposition </a>
              
            
</span>

<br /><br />
<div style="font-weight:bold; text-align:center;font-size:1.0em;">
 <i class="icon-chevron-left"></i> <a href="/archives.html">Archieves by date,</a>
 <i class="icon-list"></i> <a href="/categories.html">by category,</a>
 <i class="icon-tag"></i> <a href="/tags.html">by tag.</a>
</div>

         </div>
       </div>

      </div>
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>09 Dec 2014</span> &raquo; <a href="/2014/12/09/teaching_kids_to_program.html">How and why I'm teaching my kids to code</a></li>
    
      <li><span>14 Oct 2013</span> &raquo; <a href="/2013/10/14/CFL-disk.html">A Tale of Two Theorems</a></li>
    
      <li><span>01 Dec 2014</span> &raquo; <a href="/2014/12/01/clawpack-20.html">Clawpack turns 20</a></li>
    
  </ul>
</div>


      <!-- Disqus Comments -->
      <div class="row">
        <div class="span12">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_shortname = 'qxd'; // required: replace example with your forum shortname
                /* * * DON'T EDIT BELOW THIS LINE * * */
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        </div>
      </div>

       <footer class="footer" style="clear:both;">
         <div class="span12">
            <div class="span5" style="float:left;">

              <a href="mailto:i2000s@hotmail.com" onClick="recordOutboundLink(this, 'Outbound Links', 'email'); return false;"><img src="/assets/img/icon-email.png" alt="email"> </a>
              <a href="https://github.com/i2000s" onClick="recordOutboundLink(this, 'Outbound Links', 'Github'); return false;"><img src="/assets/img/icon-github.png" alt="github"> </a>
              <a href="https://plus.google.com/+XiaodongQi"><img src="/assets/img/icon-gplus.png" alt="G+"></a>
              <a href="http://scholar.google.com/citations?user=6FdqHlIAAAAJ&hl=en"><img src="/assets/img/icon-scholar.png" alt="G+"></a>
              <a href="https://twitter.com/i2000s"><img src="/assets/img/icon-twitter.png" alt="Twitter"></a>
              <a href="/atom.xml" onClick="recordOutboundLink(this, 'Outbound Links', 'RSS'); return false;"><img src="/assets/img/icon-rss.png" alt="feed"></a>
              <a href="http://physics.stackexchange.com/users/37682/xiaodong-qi"><img src="/assets/img/icon-stackoverflow.png" alt="Physics Stackexchange"></a>
              <div>
                <br><span> &nbsp; </span> <span><a href="/CV-XiaodongQi.pdf"> CV of Xiaodong Qi</a></span>
                <br><img alt="Creative Commons License" style="border-width:0" align="right" src="https://licensebuttons.net/l/by/3.0/88x31.png" />
                <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">This site</span> is licensed under the
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</a> or specified.
                <br>
              </div>
           </div>

           <div class="span4" style="float:right;">
              <div class="span4 team-member" marge-top="-20px">
              <img class="img-responsive img-thumbnail img-circle" width="200px" alt="" src="/assets/img/qi2016.jpg" align="middle"></img>
           </div>

      </div>
      <div class="span12" align="center" clear="both">
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">
              <span align="center" margin-top="-10px">Copyright &copy; 2016 Xiaodong Qi. </span></a>
            <br>
      </div>

    </footer>
   </div><!-- /container -->

        <!-- Le javascript
    ================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->
    <!-- JQuery, used on a few pages -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js" ></script>
    <script src="//cdn.jsdelivr.net/jquery.mixitup/latest/jquery.mixitup.min.js"></script>
    <script src="/assets/js/mixitup-mine.js"></script>
    <!-- Equations using MathJax -->
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "all"} } });       </script>
    <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'],['\\(','\\)'] ] } }); </script>
    <!-- Twitter Bootstrap Javascript -->
    <script src="/assets/js/bootstrap-collapse.js"></script> <!-- for collapsing navbar-->
    <!-- Unused Twitter Bootstrap Javascript
    <script src="http://i2000s.github.io/assets/js/bootstrap-dropdown.js"></script>
    <script src="http://i2000s.github.io/assets/js/google-code-prettify/prettify.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-transition.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-alert.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-modal.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-scrollspy.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-tab.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-tooltip.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-popover.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-button.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-carousel.js"></script>
    <script src="http://i2000s.github.io/assets/js/bootstrap-typeahead.js"></script>
    <script src="http://i2000s.github.io/assets/js/application.js"></script>
    -->

  </body>
</html>

